<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="help_title">Tr·ª£ gi√∫p & H·ªó tr·ª£</title>
    
    <link rel="stylesheet" href="../css/base.css"> 
      <link rel="stylesheet" href="../css/navbar.css"> 
      <link rel="stylesheet" href="../css/help.css"> 
</head>
<body>
    
    <div id="navbar-root"></div> 

    <div class="help-container">
        <h1 data-i18n="help_page_title">‚ùì Trung T√¢m H·ªó Tr·ª£ & C√¢u H·ªèi Th∆∞·ªùng G·∫∑p (FAQ)</h1>

        <section class="faq-section">
            <h2 data-i18n="help_section_faq">C√°c c√¢u h·ªèi ph·ªï bi·∫øn</h2>
            
            <div class="faq-item">
                <div class="faq-question">
                    <span data-i18n="faq_q1">1. L√†m sao ƒë·ªÉ t√¨m ki·∫øm ch·ªó ·ªü ph√π h·ª£p?</span>
                    <span class="faq-icon">‚ñº</span>
                </div>
                <div class="faq-answer">
                    <p data-i18n="faq_a1">B·∫°n c√≥ th·ªÉ s·ª≠ d·ª•ng trang "G·ª£i √Ω" v√† nh·∫≠p c√°c ti√™u ch√≠ nh∆∞ ƒë·ªãa ƒëi·ªÉm, kho·∫£ng gi√°, v√† ti·ªán √≠ch mong mu·ªën. H·ªá th·ªëng c·ªßa ch√∫ng t√¥i s·∫Ω ph√¢n t√≠ch d·ªØ li·ªáu v√† ƒë∆∞a ra c√°c ƒë·ªÅ xu·∫•t t·ªët nh·∫•t cho b·∫°n.</p>
                </div>
            </div>

            <div class="faq-item">
                <div class="faq-question">
                    <span data-i18n="faq_q2">2. Th√¥ng tin v·ªÅ l·ªô tr√¨nh ƒë∆∞·ª£c t√≠nh to√°n nh∆∞ th·∫ø n√†o?</span>
                    <span class="faq-icon">‚ñº</span>
                </div>
                <div class="faq-answer">
                    <p data-i18n="faq_a2">Ch·ª©c nƒÉng t√≠nh to√°n l·ªô tr√¨nh s·ª≠ d·ª•ng d·ªØ li·ªáu b·∫£n ƒë·ªì t·ª´ OpenStreetMap ƒë·ªÉ x√°c ƒë·ªãnh qu√£ng ƒë∆∞·ªùng v√† th·ªùi gian di chuy·ªÉn gi·ªØa v·ªã tr√≠ c·ªßa b·∫°n v√† ƒëi·ªÉm l∆∞u tr√∫ ƒë√£ ch·ªçn, d·ª±a tr√™n ph∆∞∆°ng ti·ªán b·∫°n ch·ªçn (√¥ t√¥, xe ƒë·∫°p, ƒëi b·ªô).</p>
                </div>
            </div>

            <div class="faq-item">
                <div class="faq-question">
                    <span data-i18n="faq_q3">3. T√¥i c√≥ th·ªÉ ƒë·∫∑t ph√≤ng tr·ª±c ti·∫øp tr√™n website kh√¥ng?</span>
                    <span class="faq-icon">‚ñº</span>
                </div>
                <div class="faq-answer">
                    <p data-i18n="faq_a3">Hi·ªán t·∫°i, n·ªÅn t·∫£ng c·ªßa ch√∫ng t√¥i ch·ªâ cung c·∫•p t√≠nh nƒÉng g·ª£i √Ω v√† ph√¢n t√≠ch. Ch√∫ng t√¥i kh√¥ng ph·∫£i l√† trang ƒë·∫∑t ph√≤ng. B·∫°n s·∫Ω c·∫ßn li√™n h·ªá v·ªõi c∆° s·ªü l∆∞u tr√∫ ho·∫∑c s·ª≠ d·ª•ng c√°c trang web ƒë·∫∑t ph√≤ng ƒë·ªëi t√°c ƒë·ªÉ ho√†n t·∫•t giao d·ªãch.</p>
                </div>
            </div>

        </section>

        <section class="contact-info">
            <h2 data-i18n="help_section_contact">‚úâ C·∫ßn h·ªó tr·ª£ th√™m?</h2>
            <p data-i18n="contact_intro">N·∫øu b·∫°n kh√¥ng t√¨m th·∫•y c√¢u tr·∫£ l·ªùi, vui l√≤ng li√™n h·ªá v·ªõi ƒë·ªôi ng≈© h·ªó tr·ª£ c·ªßa ch√∫ng t√¥i:</p>
            <p data-i18n="contact_email">Email: support@dulichvietnam.vn</p>
            <p data-i18n="contact_hotline">Hotline: 1900 3636 (Th·ªùi gian l√†m vi·ªác: 8h00 - 17h00)</p>
        </section>

    </div>

    <script>
    // --- 1. LOGIC DUY TR√å TR·∫†NG TH√ÅI ƒêƒÇNG NH·∫¨P (D√πng LOCALSTORAGE) ---

    function logoutUser() {
        localStorage.removeItem('loggedInUserEmail');
        window.location.href = 'login.html'; 
    }

    function formatEmail(email) {
        if (!email) return "Ng∆∞·ªùi d√πng";
        const parts = email.split('@');
        return parts[0]; 
    }

    function updateNavbarForLoggedInUser() {
        const userEmail = localStorage.getItem('loggedInUserEmail'); 
        const navbarRoot = document.getElementById('navbar-root');
        
        if (navbarRoot.innerHTML !== "") {
            const loginButtonContainer = navbarRoot.querySelector('.nav-right'); 

            if (userEmail) {
                const displayName = formatEmail(userEmail);
                if (loginButtonContainer) {
                    loginButtonContainer.innerHTML = `
                        <div class="user-info-group">
                            <span class="user-greeting">üëã <span data-i18n="nav_greeting">Xin ch√†o,</span> <strong>${displayName}</strong></span>
                            <button class="btn-logout" onclick="logoutUser()">
                                <img src="../../images/logout.png" class="logout-icon" style="height: 16px;">
                                <span data-i18n="nav_logout">ƒêƒÉng xu·∫•t</span>
                            </button>
                        </div>
                    `;
                }
            } else {
                if (loginButtonContainer) {
            loginButtonContainer.innerHTML = `
             <a href="login.html" class="btn-login">
                 <img src="../../images/login.png" class="login-icon">
                 <span data-i18n="nav_login">ƒêƒÉng nh·∫≠p</span>
             </a>
                `;
            }
            }
            applyTranslations();
        } else {
             setTimeout(updateNavbarForLoggedInUser, 100);
        }
    }

    // --- 2. LOGIC D·ªäCH THU·∫¨T V√Ä TOGGLE DROPWDOWN ---

    let currentTranslations = {};

    function getTranslation(key) {
        return currentTranslations[key] || key;
    }

    function applyTranslations() {
        // D·ªãch c√°c ph·∫ßn t·ª≠ c√≥ thu·ªôc t√≠nh data-i18n
        document.querySelectorAll('[data-i18n]').forEach(element => {
            const key = element.getAttribute('data-i18n');
            const translation = getTranslation(key);
            
            if (element.tagName === 'BUTTON' || element.tagName === 'A') {
                if (element.lastChild && element.lastChild.nodeType === 3) {
                    element.lastChild.textContent = translation;
                } else {
                    element.textContent = translation;
                }
            } else {
                element.textContent = translation;
            }
        });
    }

    async function loadAndApplyLanguage(lang) {
        const filePath = `../i18n/${lang}.json`;
        
        try {
            const response = await fetch(filePath);
            if (!response.ok) { throw new Error(`Kh√¥ng th·ªÉ t·∫£i file d·ªãch thu·∫≠t: ${filePath}`); }
            currentTranslations = await response.json();
            localStorage.setItem('lang', lang); 

            applyTranslations();

        } catch (error) {
            console.error("L·ªói D·ªãch thu·∫≠t:", error);
        }
    }

    function changeLanguage(lang) {
        loadAndApplyLanguage(lang);
        const menu = document.getElementById('languageMenu');
        if (menu) {
            menu.classList.add('hidden');
            document.removeEventListener('click', closeMenuOutside);
        }
        return false;
    }

    function toggleLanguageMenu() {
        const menu = document.getElementById('languageMenu');
        if (menu) {
            menu.classList.toggle('hidden'); 
            if (!menu.classList.contains('hidden')) {
                document.addEventListener('click', closeMenuOutside);
            } else {
                document.removeEventListener('click', closeMenuOutside);
            }
        }
    }

    function closeMenuOutside(event) {
        const dropdown = document.querySelector('.dropdown');
        const menu = document.getElementById('languageMenu');

        if (dropdown && menu && !dropdown.contains(event.target)) {
            menu.classList.add('hidden');
            document.removeEventListener('click', closeMenuOutside);
        }
    }

    // --- 3. KH·ªûI T·∫†O CHUNG (T·∫¢I NAVBAR, D·ªäCH THU·∫¨T & C·∫¨P NH·∫¨T TR·∫†NG TH√ÅI) ---

    document.addEventListener('DOMContentLoaded', () => {
        // 1. Load Navbar component (Gi·ªØ nguy√™n logic fetch)
        fetch('../components/navbar.html')
            .then(r => r.text())
            .then(html => { 
                document.getElementById('navbar-root').innerHTML = html; 
                
                // 2. T·∫£i ng√¥n ng·ªØ
                const defaultLang = localStorage.getItem('lang') || 'vi'; 
                loadAndApplyLanguage(defaultLang)
                    .then(() => {
                        // 3. C·∫≠p nh·∫≠t tr·∫°ng th√°i ƒëƒÉng nh·∫≠p sau khi load ng√¥n ng·ªØ v√† Navbar th√†nh c√¥ng
                        updateNavbarForLoggedInUser();
                    });
            })
            .catch(e => console.warn('Kh√¥ng th·ªÉ load navbar component', e));

        // 4. Ch·ª©c nƒÉng Accordion cho FAQ (Gi·ªØ l·∫°i logic ri√™ng c·ªßa trang n√†y)
        const faqQuestions = document.querySelectorAll('.faq-question');

        faqQuestions.forEach(question => {
            question.addEventListener('click', () => {
                // ƒê√≥ng t·∫•t c·∫£ c√°c c√¢u tr·∫£ l·ªùi kh√°c
                faqQuestions.forEach(otherQuestion => {
                    if (otherQuestion !== question && otherQuestion.classList.contains('active')) {
                        otherQuestion.classList.remove('active');
                        otherQuestion.nextElementSibling.classList.remove('active');
                    }
                });

                // M·ªü/ƒë√≥ng c√¢u tr·∫£ l·ªùi hi·ªán t·∫°i
                question.classList.toggle('active');
                const answer = question.nextElementSibling;
                answer.classList.toggle('active');
            });
        });
    });
    </script>
    
    </body>
</html>